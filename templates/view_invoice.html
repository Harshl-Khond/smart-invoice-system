<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoice #{{ invoice["invoice_no"] }}</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Global Reset and Font */
        *, *::before, *::after { box-sizing: border-box; }
        html { font-family: 'Inter', sans-serif; }

        /* --- Unique Color Palette (Teal & Gold) --- */
        :root {
            --color-primary-dark: #004d40; /* Deep Teal - Primary Corporate Color */
            --color-primary-light: #00695c;
            --color-secondary-accent: #ffb300; /* Warm Gold/Amber - Accent Color */
            --color-background-light: #f5f5f5; /* Off-White Background */
        }

        /* --- Base Styles for the Page Background (Consistent) --- */
        body {
            background-color: var(--color-background-light);
            background-image: linear-gradient(180deg, #f5f5f5 50%, #eceff1 100%);
            min-height: 100vh;
            padding: 1.5rem;
        }

        /* Card Design: Clean White, Elevated */
        .unique-card {
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }

        /* Header Accent */
        .header-accent {
            color: var(--color-primary-dark);
        }

        /* Table header background color (Deep Teal) */
        .table-header {
            background-color: var(--color-primary-dark);
        }

        /* Primary Button Style (Teal) */
        .btn-primary {
            background-color: var(--color-primary-light);
            transition: background-color 0.2s ease;
        }
        .btn-primary:hover {
            background-color: var(--color-primary-dark);
        }

        /* Accent Button Style (Gold for secondary actions/links) */
        .btn-secondary-accent {
            background-color: var(--color-secondary-accent);
            color: var(--color-primary-dark);
            font-weight: 600;
            transition: background-color 0.2s ease;
        }
        .btn-secondary-accent:hover {
             background-color: #ffc133;
        }

        /* Secondary Button Style (Gray for back links) */
        .btn-secondary-gray {
            background-color: #6b7280; /* gray-500 */
            transition: background-color 0.2s ease;
        }
        .btn-secondary-gray:hover {
             background-color: #4b5563; /* gray-700 */
        }

        /* --- MOBILE FULL-SCREEN PROFESSIONAL LOOK --- */
        @media (max-width: 640px) {
            body {
                padding: 0;
            }
            .max-w-5xl {
                padding: 0;
                margin: 0;
            }
            /* Make the invoice panels edge-to-edge */
            .unique-card {
                border-radius: 0;
                box-shadow: none;
                border-left: none !important;
                border-right: none !important;
                border-top: 1px solid #e5e7eb; /* Subtle separator for stacked cards */
            }
            /* Fix padding for stacked mobile cards */
            .grid > .unique-card {
                padding: 1.5rem;
            }
        }
    </style>
    <script>
        // Custom Tailwind Configuration for unique colors
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-teal': '#004d40',
                        'primary-light': '#00695c',
                        'accent-gold': '#ffb300',
                    }
                }
            }
        }
    </script>
</head>

<body>
<div class="max-w-5xl mx-auto space-y-6">

    <div class="unique-card p-6 sm:p-8 text-center">
        <h1 class="text-4xl font-extrabold header-accent mb-2">TAX INVOICE</h1>
        <h2 class="text-2xl font-bold text-gray-700 mb-4">{{ company["company_name"] }}</h2>

        <div class="text-sm text-gray-600 space-y-1">
            <p><span class="font-semibold text-primary-light">Address:</span> {{ company["address"] }}</p>
            <p><span class="font-semibold text-primary-light">Email:</span> {{ company["email"] }}</p>
            <p><span class="font-semibold text-primary-light">Phone:</span> {{ company["phone_no"] }}</p>
            <p><span class="font-semibold text-primary-light">GST No:</span> {{ company["gst_no"] }}</p>
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

        <div class="unique-card p-6 space-y-3 lg:col-span-1 border-l-4 border-primary-light">
            <h3 class="text-xl font-bold header-accent border-b border-gray-100 pb-2 mb-3">Invoice Details</h3>
            <p class="text-gray-700"><span class="font-semibold">Invoice No:</span> <span class="text-primary-dark font-extrabold">{{ invoice["invoice_no"] }}</span></p>
            <p class="text-gray-700"><span class="font-semibold">Department:</span> {{ invoice["department"] | default('N/A', true) }}</p>
            <p class="text-gray-700"><span class="font-semibold">Invoice Date:</span> {{ invoice["invoice_date"] }}</p>
            <p class="text-gray-700"><span class="font-semibold">Due Date:</span> <span class="text-red-600 font-semibold">{{ invoice["due_date"] }}</span></p>
        </div>

        <div class="unique-card p-6 space-y-3 lg:col-span-2 border-l-4 border-primary-light">
            <h3 class="text-xl font-bold header-accent border-b border-gray-100 pb-2 mb-3">Customer Information</h3>
            <p class="text-gray-700"><span class="font-semibold">Name:</span> {{ invoice["client_name"] }}</p>
            <p class="text-gray-700"><span class="font-semibold">Email:</span> {{ invoice["client_email"] }}</p>
            <p class="text-gray-700"><span class="font-semibold">Purchase No:</span> {{ invoice["client_po"] }}</p>
            <p class="text-gray-700"><span class="font-semibold">Phone:</span> {{ invoice["client_phone"] }}</p>
            <p class="text-gray-700"><span class="font-semibold">Address:</span> {{ invoice["client_address"] }}</p>
        </div>
    </div>

    <div class="unique-card p-6">
        <h3 class="text-xl font-bold header-accent border-b border-gray-100 pb-2 mb-4">Items / Services</h3>

        <div class="overflow-x-auto rounded-lg border border-gray-200 shadow-inner">
            <table class="min-w-full divide-y divide-gray-200">
                <thead>
                    <tr>
                        <th class="table-header text-left text-sm font-semibold text-white uppercase tracking-wider p-4">Item / Service</th>
                        <th class="table-header text-center text-sm font-semibold text-white uppercase tracking-wider p-4">Qty</th>
                        <th class="table-header text-right text-sm font-semibold text-white uppercase tracking-wider p-4">Unit Price (₹)</th>
                        <th class="table-header text-right text-sm font-semibold text-white uppercase tracking-wider p-4">Total (₹)</th>
                    </tr>
                </thead>
                <tbody class="bg-white divide-y divide-gray-100">
                    {% for item in invoice["items"] %}
                    <tr class="even:bg-gray-50 hover:bg-teal-50/50 transition-colors">
                        <td class="px-4 py-3 whitespace-normal text-sm font-medium text-gray-900">{{ item["item_name"] }}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-700 text-center">{{ item["quantity"] }}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm text-gray-700 text-right">{{ "%.2f"|format(item["unit_price"]) }}</td>
                        <td class="px-4 py-3 whitespace-nowrap text-sm font-bold text-primary-dark text-right">{{ "%.2f"|format(item["total"]) }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

        <div class="unique-card p-6 space-y-2 lg:col-span-2">
            <h3 class="text-xl font-bold header-accent border-b border-gray-100 pb-2 mb-3">Payment Terms & Notes</h3>
            <p class="text-gray-700 text-sm italic"><span class="font-semibold text-primary-light">Terms:</span> Payment is due within 7 days of the invoice date.</p>
            <p class="text-gray-700 text-sm"><span class="font-semibold text-primary-light">Notes:</span> {{ invoice["notes"] | default('No special notes.', true) }}</p>
        </div>

        <div class="unique-card p-6 space-y-3 lg:col-span-1">

            <div class="flex justify-between items-center border-b border-gray-200 pb-2">
                <p class="font-medium text-gray-700">Subtotal:</p>
                <p class="font-semibold text-lg text-gray-800">₹{{ "%.2f"|format(invoice["subtotal"]) }}</p>
            </div>

            <div class="flex justify-between items-center border-b border-gray-200 pb-2">
                <p class="font-medium text-gray-700">GST Amount:</p>
                <p class="font-semibold text-lg text-gray-800">₹{{ "%.2f"|format(invoice["gst_amount"]) }}</p>
            </div>

            <div class="flex justify-between items-center pt-2">
                <p class="text-xl font-extrabold header-accent">Final Total:</p>
                <p class="text-2xl font-extrabold text-accent-gold">₹{{ "%.2f"|format(invoice["final_total"]) }}</p>
            </div>
        </div>
    </div>

    <div class="actions text-center pt-4 space-x-4">
        <a href="{{ url_for('download_invoice_pdf', doc_id=invoice['doc_id']) }}"
           class="btn-primary inline-block py-3 px-6 text-white font-semibold rounded-lg shadow-lg transform hover:scale-[1.05] active:scale-[0.99] focus:ring-4 focus:ring-primary-light/50">
            ⬇️ Download Invoice (PDF)
        </a>
        <a href="{{ url_for('user_dashboard') }}"
           class="btn-secondary-gray inline-block py-3 px-6 text-white font-semibold rounded-lg shadow-md transform hover:scale-[1.02] active:scale-[0.99]" style="margin-top: 20px;">
            Back to Dashboard
        </a>
    </div>

</div>
</body>
</html>
